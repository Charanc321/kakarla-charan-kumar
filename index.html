<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Charan Tracker Â· Glow + Drag&Drop + Inline Add</title>
  <style>
    :root{
      --bg1:#031a13;  --bg2:#061b2e;  --bg3:#04131f;
      --card:#0a1422; --card2:#0b1220; --edge:#17324a;
      --text:#dff4ff; --muted:#9dc2d9;
      --accentG:#22c55e; --accentB:#08a0ff; --accentC:#06b6d4; --warn:#f59e0b; --danger:#ef4444;
      --shadow:0 10px 34px rgba(0,0,0,.55);
      --radius:18px;
      --glow: rgba(255, 245, 160, .22);
      --lift: translateY(-6px);
      --lift-shadow: 0 14px 26px rgba(0,0,0,.35);
    }

    body{
      margin:0; color:var(--text); font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
      background:
        radial-gradient(1200px 700px at 10% 20%, rgba(13,185,110,.18), transparent 60%),
        radial-gradient(900px 600px at 85% 25%, rgba(8,160,255,.18), transparent 60%),
        linear-gradient(130deg, var(--bg1), var(--bg2) 50%, var(--bg3));
      background-size: 220% 220%;
      animation:bgflow 18s ease-in-out infinite;
      min-height:100vh; overflow-x:hidden;
    }
    @keyframes bgflow{ 0%{background-position:0% 50%} 50%{background-position:100% 50%} 100%{background-position:0% 50%} }

    .cursor-glow{ position:fixed; inset:0; pointer-events:none; z-index:0; opacity:.9; }
    .cursor-glow::before{
      content:""; position:absolute; width:100vw; height:100vh; left:0; top:0;
      background: radial-gradient(220px 220px at var(--mx,50%) var(--my,50%), var(--glow), transparent 60%);
      filter: blur(16px) saturate(130%); transition: opacity .25s ease; mix-blend-mode: screen;
    }
    body.no-glow .cursor-glow{opacity:0}

    .container{max-width:1100px; margin:36px auto; padding:0 16px; position:relative; z-index:1}

    header{display:flex; align-items:center; justify-content:space-between; gap:16px; position:sticky; top:8px; z-index:5}
    .brand{display:flex; align-items:center; gap:14px}

    .logo-text{font-weight:900; font-size:clamp(24px,4vw,34px); letter-spacing:.6px;
      background:linear-gradient(90deg, #00ff9d, #22c55e, #06b6d4, #08a0ff, #00ff9d);
      -webkit-background-clip:text; background-clip:text; color:transparent;
      filter:drop-shadow(0 8px 24px rgba(6,182,212,.25));
      background-size:240% 100%; animation:shine 7s linear infinite}
    @keyframes shine{0%{background-position:0%}100%{background-position:240%}}

    .today{opacity:.95; font-weight:600}

    .panel{background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.015));
      border:1px solid var(--edge); border-radius:var(--radius); box-shadow:var(--shadow); padding:14px}

    .add-bar{display:grid; grid-template-columns:1fr 130px 140px 150px auto; gap:10px; align-items:center}

    .input, select{
      background:#0a1a2c; color:var(--text); border:1px solid #1e3650; padding:12px 14px; border-radius:12px; outline:none;
      transition: transform .14s ease, box-shadow .14s ease, border-color .2s ease;
    }
    .input::placeholder{color:#7aa5be}
    .input:hover, .input:focus, select:hover, select:focus{
      transform:var(--lift); box-shadow:var(--lift-shadow); border-color:#2b5f86;
    }

    .btn{
      cursor:pointer; border:none; padding:12px 16px; border-radius:12px; font-weight:800; letter-spacing:.2px;
      background:linear-gradient(135deg,#19c37d,#0ea5e9); color:#def7ff; box-shadow:0 10px 24px rgba(14,165,233,.28);
      transition:transform .12s ease, filter .2s, box-shadow .12s ease;
    }
    .btn:hover, .btn:focus-visible{ transform:var(--lift); box-shadow:var(--lift-shadow) }
    .btn:active{transform:translateY(1px)}

    .filters{display:flex; gap:10px; flex-wrap:wrap; margin-top:12px}
    .chip{
      border:1px solid #1e3650; background:#0b1526; color:#cfeaff;
      padding:10px 14px; border-radius:999px; cursor:pointer; touch-action:manipulation;
      transition:transform .16s ease, box-shadow .16s ease, border-color .2s ease;
      will-change: transform;
    }
    .chip:hover, .chip:focus-visible{ transform:var(--lift); box-shadow:var(--lift-shadow) }
    .chip.active{border-color:#19c37d; background:#0c1c30}

    .grid{display:grid; grid-template-columns:1.1fr .9fr .9fr; gap:16px; margin-top:16px}

    .card{
      background:linear-gradient(180deg, rgba(0,0,0,0.38), rgba(0,0,0,0.2));
      border:1px solid var(--edge); border-radius:var(--radius); box-shadow:var(--shadow); padding:16px; min-height:280px;
      transition:transform .18s ease, box-shadow .18s ease
    }
    .card:hover{transform:translateY(-8px); box-shadow:0 16px 40px rgba(0,0,0,.55)}
    .card.today{border-top:4px solid var(--accentG)}
    .card.upcoming{border-top:4px solid var(--accentB)}
    .card.done{border-top:4px solid var(--accentC)}
    .card h3{margin:0 0 10px 0; display:inline-flex; align-items:center; gap:8px}
    .card h3::after{content:'â†—'; font-size:12px; opacity:.6; transition:transform .2s ease, opacity .2s}
    .card:hover h3::after{transform:translateY(-4px); opacity:1}

    .list{display:flex; flex-direction:column; gap:10px}

    .task{
      display:grid; grid-template-columns:auto 1fr auto; gap:10px; align-items:center;
      background:#0b1220; border:1px solid #1e3650; border-radius:14px; padding:12px;
      position:relative; overflow:hidden; color:#e6f7ff; touch-action:none;
      transition: transform .14s ease, box-shadow .14s ease, border-color .2s ease;
    }
    .task:hover{ transform:var(--lift); box-shadow:var(--lift-shadow) }
    .task.low{border-left:4px solid #19c37d}
    .task.med{border-left:4px solid #0ea5e9}
    .task.high{border-left:4px solid #f97316}

    .check{appearance:none; width:24px; height:24px; border-radius:7px; border:2px solid #3d5a73; display:grid; place-items:center; cursor:pointer; transition:all .25s ease; background:transparent}
    .check:checked{background:linear-gradient(135deg,#19c37d,#0ea5e9); border-color:transparent; box-shadow:0 6px 18px rgba(14,165,233,.25)}
    .check:checked::after{content:"âœ“"; font-weight:900; color:#04121d}

    .title{font-weight:800; color:#e6f7ff; text-shadow:0 1px 2px rgba(0,0,0,.35)}
    .meta{font-size:12px; color:#a7cbe0}

    .actions{display:flex; gap:8px}
    .icon-btn{
      background:#0b1526; border:1px solid #204769; color:#cde8ff; padding:8px 10px; border-radius:10px; cursor:pointer;
      transition: transform .12s ease, box-shadow .12s ease, border-color .2s ease;
    }
    .icon-btn:hover, .icon-btn:focus-visible{ border-color:#19c37d; transform:var(--lift); box-shadow:var(--lift-shadow) }

    .progress{height:10px; background:#0b1526; border-radius:999px; overflow:hidden; border:1px solid #1e3650}
    .bar{height:100%; width:0%; background:linear-gradient(90deg,#19c37d,#06b6d4,#0ea5e9); transition:width .45s ease}
    .stats{display:flex; align-items:center; gap:12px; color:#a7cbe0}

    /* drag & drop helpers */
    .card.drop-hover{outline:2px dashed #19c37d; outline-offset:4px}
    .task.dragging{opacity:.6; transform:scale(.98)}
    .drag-ghost{
      position:fixed; pointer-events:none; left:0; top:0; transform:translate(-9999px,-9999px);
      z-index:9999; opacity:.95; filter:drop-shadow(0 8px 18px rgba(0,0,0,.6));
    }

    /* Inline adder */
    .adder{
      background:#0b1526; border:1px dashed #2b4f6d; border-radius:12px; padding:10px; display:grid; gap:8px;
      grid-template-columns:1fr 120px 150px auto; align-items:center;
      transition: transform .12s ease, box-shadow .12s ease;
    }
    .adder:hover{ transform:var(--lift); box-shadow:var(--lift-shadow) }
    .btn-lite{
      border:1px dashed #2b4f6d; background:#0b1526; color:#cfeaff; padding:10px 12px; border-radius:12px; cursor:pointer;
      transition: transform .12s ease, box-shadow .12s ease, border-color .2s ease;
    }
    .btn-lite:hover, .btn-lite:focus-visible{ transform:var(--lift); box-shadow:var(--lift-shadow); border-color:#19c37d }

    /* Toast */
    .toast{
      position:fixed; bottom:18px; left:50%; transform:translateX(-50%) translateY(20px);
      background:#0b1526; border:1px solid #1e3650; color:#dff4ff;
      padding:10px 14px; border-radius:12px; opacity:0; transition:all .25s ease; z-index:1000;
    }
    .toast.show{opacity:1; transform:translateX(-50%) translateY(0)}

    @media (max-width:920px){
      .grid{grid-template-columns:1fr}
      .add-bar{grid-template-columns:1fr 1fr; grid-auto-rows:minmax(44px,auto)}
      .add-bar select, .add-bar input[type="date"]{height:44px}
      .add-bar input[type="date"]{order:4}
      .btn{order:5}
      .actions .icon-btn{padding:10px 12px}
      .task{grid-template-columns:auto 1fr; gap:8px}
      .actions{grid-column:1 / -1}
      .adder{grid-template-columns:1fr 1fr; grid-auto-rows:minmax(44px,auto)}
    }
  </style>
</head>
<body>
  <div class="cursor-glow" id="cursorGlow"></div>

  <div class="container">
    <header>
      <div class="brand">
        <div class="logo-text">Charan Tracker</div>
        <div><div class="today" id="todayText"></div></div>
      </div>
      <div class="stats">
        <div style="min-width:180px">
          <div class="progress" aria-label="completion">
            <div class="bar" id="progressBar"></div>
          </div>
        </div>
        <span id="statText">0/0 done</span>
      </div>
    </header>

    <div class="panel add-bar" role="region" aria-label="Add task">
      <input id="taskInput" class="input" placeholder="Add a taskâ€¦ e.g., Study Python 30 mins" />
      <select id="priority">
        <option value="low">Low</option>
        <option value="med">Medium</option>
        <option value="high">High</option>
      </select>
      <select id="bucket">
        <option value="today">Today</option>
        <option value="upcoming">Upcoming</option>
      </select>
      <input id="due" class="input" type="date" />
      <button class="btn" id="addBtn">Add Task</button>
    </div>

    <div class="filters" role="tablist" aria-label="Filters">
      <button class="chip active" data-filter="all" role="tab" aria-selected="true">All</button>
      <button class="chip" data-filter="today" role="tab" aria-selected="false">Today</button>
      <button class="chip" data-filter="upcoming" role="tab" aria-selected="false">Upcoming</button>
      <button class="chip" data-filter="completed" role="tab" aria-selected="false">Completed</button>
      <input id="search" class="input" style="max-width:260px" placeholder="Search tasks" />
      <button class="chip" id="clearDone" title="Clear completed">Clear completed</button>
    </div>

    <div class="grid" style="margin-top:18px">
      <section class="card today" aria-labelledby="col-today">
        <h3 id="col-today">Today</h3>
        <div class="list droptarget" id="list-today"></div>
        <button class="add-inline btn-lite" data-bucket="today">ï¼‹ Add task</button>
      </section>
      <section class="card upcoming" aria-labelledby="col-upcoming">
        <h3 id="col-upcoming">Upcoming</h3>
        <div class="list droptarget" id="list-upcoming"></div>
        <button class="add-inline btn-lite" data-bucket="upcoming">ï¼‹ Add task</button>
      </section>
      <section class="card done" aria-labelledby="col-done">
        <h3 id="col-done">Completed</h3>
        <div class="list droptarget" id="list-done"></div>
        <button class="add-inline btn-lite" data-bucket="done">ï¼‹ Add task</button>
      </section>
    </div>
  </div>

  <div class="toast" id="toast" role="status" aria-live="polite"></div>
  <canvas id="confettiCanvas" style="position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:999;"></canvas>

  <script>
    const $ = (q,root=document)=>root.querySelector(q);
    const $$ = (q,root=document)=>Array.from(root.querySelectorAll(q));
    const uid = ()=> Math.random().toString(36).slice(2,9);
    const STORAGE_KEY = 'charan.tracker.v2';

    const state = { tasks: loadTasks(), filter:'all', search:'' };

    function loadTasks(){ try{ return JSON.parse(localStorage.getItem(STORAGE_KEY)||'[]'); }catch(e){ return [] } }
    function saveTasks(){ localStorage.setItem(STORAGE_KEY, JSON.stringify(state.tasks)); }

    function visibleTasks(){
      const q = state.search.trim().toLowerCase();
      return state.tasks.filter(t=>{
        if(state.filter==='today' && (t.done || (t.bucket||'today')!=='today')) return false;
        if(state.filter==='upcoming' && (t.done || (t.bucket||'today')!=='upcoming')) return false;
        if(state.filter==='completed' && !t.done) return false;
        if(q && !t.title.toLowerCase().includes(q)) return false;
        return true;
      });
    }

    function render(){
      const todayList = $('#list-today'), upcList=$('#list-upcoming'), doneList=$('#list-done');
      [todayList,upcList,doneList].forEach(el=> el.innerHTML='');

      const vis = visibleTasks();
      const total = state.tasks.length; const completed = state.tasks.filter(t=>t.done).length;
      $('#statText').textContent = `${completed}/${total} done`;
      $('#progressBar').style.width = total? ((completed/total)*100).toFixed(1)+'%':'0%';

      vis.forEach(t=>{
        const el = taskItem(t);
        if(t.done){ doneList.appendChild(el); }
        else if((t.bucket||'today')==='today'){ todayList.appendChild(el); }
        else { upcList.appendChild(el); }
      });

      const d = new Date();
      $('#todayText').textContent = d.toLocaleDateString(undefined,{weekday:'long', month:'short', day:'numeric', year:'numeric'});

      setupDnD();
      setupTouchDnD();
      wireInlineAdders();
    }

    function taskItem(task){
      const li = document.createElement('div');
      li.className = `task ${task.priority||'low'}`;
      li.dataset.id = task.id;

      // desktop drag
      li.setAttribute('draggable','true');
      li.addEventListener('dragstart', (e)=>{
        li.classList.add('dragging');
        e.dataTransfer.setData('text/plain', task.id);
        e.dataTransfer.effectAllowed='move';
      });
      li.addEventListener('dragend', ()=> li.classList.remove('dragging'));

      li.innerHTML = `
        <input class="check" type="checkbox" ${task.done?'checked':''} aria-label="Mark done">
        <div>
          <div class="title">${escapeHtml(task.title)}</div>
          <div class="meta">${(task.done?'DONE':(task.bucket||'today').toUpperCase())}${task.priority? ' â€¢ '+task.priority.toUpperCase():''}${task.due? ' â€¢ Due: '+task.due:''}</div>
        </div>
        <div class="actions">
          <button class="icon-btn" data-act="edit" aria-label="Edit">Edit</button>
          <button class="icon-btn" data-act="move" aria-label="Move">Move</button>
          <button class="icon-btn" data-act="del" aria-label="Delete">Delete</button>
        </div>`;

      li.querySelector('.check').addEventListener('change', e=>{
        task.done = e.target.checked;
        saveTasks(); render();
        if (task.done) confettiBurst();
        toast(task.done?'Great job! âœ…':'Marked as not done');
      });

      li.querySelector('[data-act="del"]').addEventListener('click', ()=>{
        state.tasks = state.tasks.filter(x=>x.id!==task.id); saveTasks(); render(); toast('Task deleted');
      });
      li.querySelector('[data-act="edit"]').addEventListener('click', ()=>{
        const t = prompt('Edit task title', task.title);
        if(t!==null){ task.title=t.trim()||task.title; saveTasks(); render(); toast('Task updated'); }
      });
      li.querySelector('[data-act="move"]').addEventListener('click', ()=>{
        task.bucket = (task.bucket==='today')?'upcoming':'today'; task.done=false; saveTasks(); render(); toast('Task moved');
      });
      return li;
    }

    // HTML5 DnD for desktop
    function setupDnD(){
      $$('.droptarget').forEach(z =>{
        z.ondragover = (e)=>{ e.preventDefault(); z.closest('.card').classList.add('drop-hover'); e.dataTransfer.dropEffect='move'; };
        z.ondragleave = ()=> z.closest('.card').classList.remove('drop-hover');
        z.ondrop = (e)=>{
          e.preventDefault();
          z.closest('.card').classList.remove('drop-hover');
          const id = e.dataTransfer.getData('text/plain');
          assignDrop(id, z.id);
        };
      });
    }

    // Pointer-based drag for touch/pen (mobile/tablet)
    let touchDragging = null, ghost = null, activePointerHost = null;

    function setupTouchDnD(){
      $$('.task').forEach(el=>{
        el.onpointerdown = startPointerDrag;
      });
    }

    function startPointerDrag(e){
      if(!(e.pointerType==='touch' || e.pointerType==='pen')) return; // touch/pen only
      const interactive = ['INPUT','BUTTON'];
      if (interactive.includes(e.target.tagName)) return;

      const taskEl = e.currentTarget;
      activePointerHost = taskEl;

      touchDragging = { id: taskEl.dataset.id, lastX:e.clientX, lastY:e.clientY, pointerId:e.pointerId };

      // ghost preview
      ghost = taskEl.cloneNode(true);
      ghost.classList.add('drag-ghost');
      const rect = taskEl.getBoundingClientRect();
      ghost.style.width = rect.width + 'px';
      document.body.appendChild(ghost);
      positionGhost(e.clientX, e.clientY);
      highlightZoneAt(e.clientX, e.clientY);

      taskEl.setPointerCapture(e.pointerId);
      taskEl.addEventListener('pointermove', onPointerMove);
      taskEl.addEventListener('pointerup', onPointerUp, {once:true});
      taskEl.addEventListener('pointercancel', onPointerCancel, {once:true});
    }

    function onPointerMove(e){
      if(!touchDragging || e.pointerId!==touchDragging.pointerId) return;
      touchDragging.lastX = e.clientX; touchDragging.lastY = e.clientY;
      positionGhost(e.clientX, e.clientY);
      highlightZoneAt(e.clientX, e.clientY);
    }

    function onPointerUp(e){
      if(!touchDragging || e.pointerId!==touchDragging.pointerId) { cleanupPointerDrag(); return; }
      const { lastX:x, lastY:y, id } = touchDragging;
      const zone = findDropZoneAtPoint(x,y);
      if(zone){ assignDrop(id, zone.id); }
      cleanupPointerDrag();
    }

    function onPointerCancel(){ cleanupPointerDrag(); }

    function cleanupPointerDrag(){
      clearZoneHighlights();
      if(ghost){ ghost.remove(); ghost=null; }
      if(activePointerHost){
        try{
          activePointerHost.releasePointerCapture(touchDragging?.pointerId ?? 0);
        }catch(_){}
        activePointerHost.removeEventListener('pointermove', onPointerMove);
        activePointerHost = null;
      }
      touchDragging = null;
    }

    function positionGhost(x,y){
      if(!ghost) return;
      const offset = 20;
      ghost.style.transform = `translate(${x+offset}px, ${y+offset}px)`;
    }

    function highlightZoneAt(x,y){
      clearZoneHighlights();
      const z = findDropZoneAtPoint(x,y);
      if(z) z.closest('.card').classList.add('drop-hover');
    }

    function clearZoneHighlights(){
      $$('.card.drop-hover').forEach(c=>c.classList.remove('drop-hover'));
    }

    function findDropZoneAtPoint(x,y){
      const el = document.elementFromPoint(x,y);
      if(!el) return null;
      return el.closest('.droptarget');
    }

    function assignDrop(taskId, listId){
      const t = state.tasks.find(x=> x.id===taskId);
      if(!t) return;

      if (listId === 'list-done') { t.done = true; confettiBurst(); toast('Completed! ðŸŽ‰'); }
      else if (listId === 'list-today') { t.done = false; t.bucket = 'today'; toast('Moved to Today'); }
      else if (listId === 'list-upcoming') { t.done = false; t.bucket = 'upcoming'; toast('Moved to Upcoming'); }
      saveTasks(); render();
    }

    function addTask(){
      const input = $('#taskInput'); const title = (input.value||'').trim();
      if(!title){ toast('Please enter a task'); input.focus(); return; }
      const priority = $('#priority').value; const bucket = $('#bucket').value; const due = $('#due').value;
      const item = { id:uid(), title, priority, bucket, due, done:false, created:Date.now() };
      state.tasks.unshift(item); saveTasks(); input.value=''; render(); toast('Task added');
    }

    // Inline adders at bottom of each column
    function wireInlineAdders(){
      $$('.add-inline').forEach(btn=>{
        btn.onclick = ()=>{
          const section = btn.closest('section');
          // remove any existing adder in this section
          const exist = section.querySelector('.adder');
          if(exist){ exist.remove(); }
          openInlineAdder(section, btn.dataset.bucket || 'today', btn);
        };
      });
    }

    function openInlineAdder(section, bucket, anchorBtn){
      const adder = document.createElement('div');
      adder.className = 'adder';
      adder.innerHTML = `
        <input class="input" placeholder="Task title" aria-label="Task title" />
        <select class="input" aria-label="Priority">
          <option value="low">Low</option>
          <option value="med">Medium</option>
          <option value="high">High</option>
        </select>
        <input class="input" type="date" aria-label="Due date" />
        <div style="display:flex; gap:8px; justify-content:flex-end">
          <button class="btn-lite" data-act="cancel">Cancel</button>
          <button class="btn" data-act="save">Save</button>
        </div>
      `;
      anchorBtn.insertAdjacentElement('beforebegin', adder);
      const titleEl = adder.querySelector('input[type="text"], input:not([type])') || adder.querySelector('input');
      const priEl = adder.querySelector('select');
      const dueEl = adder.querySelector('input[type="date"]');
      if(bucket==='today'||bucket==='upcoming'){ priEl.value='low'; }
      if(bucket==='done'){ priEl.value='low'; }

      adder.querySelector('[data-act="cancel"]').onclick = ()=> adder.remove();
      adder.querySelector('[data-act="save"]').onclick = ()=>{
        const title = (titleEl.value||'').trim();
        if(!title){ toast('Please enter a task'); titleEl.focus(); return; }
        const item = {
          id:uid(), title, priority:priEl.value, bucket:(bucket==='done'?'today':bucket),
          due: dueEl.value, done: bucket==='done', created:Date.now()
        };
        state.tasks.unshift(item); saveTasks(); render();
        toast(bucket==='done'?'Added to Completed':'Task added');
        if(bucket==='done') confettiBurst();
      };
      titleEl && titleEl.focus();
    }

    // Filters & search (floating chips)
    $$('.chip').forEach(ch=> ch.addEventListener('click', ()=>{
      if(ch.id==='clearDone'){
        state.tasks = state.tasks.filter(t=>!t.done); saveTasks(); render(); toast('Cleared completed'); return;
      }
      $$('.chip').forEach(c=>{
        c.classList.remove('active');
        if(c.getAttribute('role')==='tab') c.setAttribute('aria-selected','false');
      });
      ch.classList.add('active');
      if(ch.getAttribute('role')==='tab') ch.setAttribute('aria-selected','true');
      state.filter = ch.dataset.filter || state.filter;
      render();
    }));
    $('#search').addEventListener('input', e=>{ state.search = e.target.value.toLowerCase(); render(); });

    // Add actions (top bar)
    $('#addBtn').addEventListener('click', addTask);
    $('#taskInput').addEventListener('keydown', e=>{ if(e.key==='Enter') addTask(); });

    // Toast
    const toastEl = $('#toast'); let toastTimer;
    function toast(msg){ toastEl.textContent = msg; toastEl.classList.add('show'); clearTimeout(toastTimer); toastTimer=setTimeout(()=>toastEl.classList.remove('show'), 1600); }

    function escapeHtml(s){ return String(s).replace(/[&<>\"']/g, (ch)=>({ '&':'&amp;','<':'&lt;','>':'&gt;','\"':'&quot;','\'':'&#39;' }[ch])); }

    // Cursor glow follow
    let pending = false;
    window.addEventListener('mousemove', (e)=>{ const mx = e.clientX + 'px', my = e.clientY + 'px'; if(!pending){ pending = true; requestAnimationFrame(()=>{ document.documentElement.style.setProperty('--mx', mx); document.documentElement.style.setProperty('--my', my); pending=false; }); } });
    window.addEventListener('mouseleave', ()=> document.body.classList.add('no-glow'));
    window.addEventListener('mouseenter', ()=> document.body.classList.remove('no-glow'));

    // Confetti
    function confettiBurst(count = 150) {
      const canvas = document.getElementById("confettiCanvas");
      const ctx = canvas.getContext("2d");
      canvas.width = window.innerWidth; canvas.height = window.innerHeight;
      const w = canvas.width, h = canvas.height;
      const pieces = [];
      const palette = ["#FFD700","#F5C518","#1E3A8A","#2563EB"];

      for (let i = 0; i < count; i++) {
        pieces.push({ x: Math.random() * w, y: Math.random() * -h, r: Math.random() * 6 + 4, c: palette[Math.floor(Math.random()*palette.length)], s: Math.random() * 4 + 2, a: Math.random() * Math.PI * 2 });
      }

      const gravity = 0.3;
      let frame = 0, raf;

      function draw() {
        ctx.clearRect(0, 0, w, h);
        frame++;
        for (const p of pieces) {
          p.y += p.s + gravity;
          p.x += Math.sin(p.a + frame * 0.02) * 2;
          if (p.y > h) { p.y = -10; p.x = Math.random()*w; }
          ctx.beginPath(); ctx.fillStyle = p.c; ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2); ctx.fill();
        }
        raf = requestAnimationFrame(draw);
      }
      draw();
      setTimeout(() => { cancelAnimationFrame(raf); ctx.clearRect(0, 0, w, h); }, 4000);
    }

    // Init
    render();

    // Keep confetti canvas responsive
    window.addEventListener('resize', ()=>{
      const canvas = document.getElementById("confettiCanvas");
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    });
  </script>
</body>
</html>
