<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Charan Tracker Â· Greenâ€“Blue + Cursor Glow + Drag&Drop + Confetti</title>
  <style>
    :root{
      --bg1:#031a13;  /* deep green */
      --bg2:#061b2e;  /* deep blue */
      --bg3:#04131f;  /* indigo navy */
      --card:#0a1422; --card2:#0b1220; --edge:#17324a;
      --text:#dff4ff; --muted:#9dc2d9;
      --accentG:#22c55e; --accentB:#08a0ff; --accentC:#06b6d4; --warn:#f59e0b; --danger:#ef4444;
      --shadow:0 10px 34px rgba(0,0,0,.55);
      --radius:18px;
      --glow: rgba(255, 245, 160, .22); /* light yellow glow */
    }

    /* ===== Global Dark Background with GREENâ†”BLUE animation ===== */
    body{
      margin:0; color:var(--text); font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
      background:
        radial-gradient(1200px 700px at 10% 20%, rgba(13,185,110,.18), transparent 60%),
        radial-gradient(900px 600px at 85% 25%, rgba(8,160,255,.18), transparent 60%),
        linear-gradient(130deg, var(--bg1), var(--bg2) 50%, var(--bg3));
      background-size: 220% 220%;
      animation:bgflow 18s ease-in-out infinite;
      min-height:100vh; overflow-x:hidden;
    }
    @keyframes bgflow{ 0%{background-position:0% 50%} 50%{background-position:100% 50%} 100%{background-position:0% 50%} }

    /* Cursor-following soft yellow glow */
    .cursor-glow{ position:fixed; inset:0; pointer-events:none; z-index:0; opacity:.9; }
    .cursor-glow::before{
      content:""; position:absolute; width:100vw; height:100vh; left:0; top:0;
      background: radial-gradient(220px 220px at var(--mx,50%) var(--my,50%), var(--glow), transparent 60%);
      filter: blur(16px) saturate(130%);
      transition: opacity .25s ease;
      mix-blend-mode: screen;
    }
    body.no-glow .cursor-glow{opacity:0}

    .container{max-width:1100px; margin:36px auto; padding:0 16px; position:relative; z-index:1}

    header{display:flex; align-items:center; justify-content:space-between; gap:16px}
    .brand{display:flex; align-items:center; gap:14px}

    /* Animated gradient text logo (greenâ†’cyanâ†’blue) */
    .logo-text{font-weight:900; font-size:clamp(24px,4vw,34px); letter-spacing:.6px;
      background:linear-gradient(90deg, #00ff9d, #22c55e, #06b6d4, #08a0ff, #00ff9d);
      -webkit-background-clip:text; background-clip:text; color:transparent;
      filter:drop-shadow(0 8px 24px rgba(6,182,212,.25));
      background-size:240% 100%; animation:shine 7s linear infinite}
    @keyframes shine{0%{background-position:0%}100%{background-position:240%}}

    h1{margin:0; font-size:clamp(18px,2.3vw,22px); color:#b9e6ff}
    .today{opacity:.95; font-weight:600}

    .panel{background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.015));
      border:1px solid var(--edge); border-radius:var(--radius); box-shadow:var(--shadow); padding:14px}

    .add-bar{display:grid; grid-template-columns:1fr 130px 140px 150px auto; gap:10px; align-items:center}
    .input, select{background:#0a1a2c; color:var(--text); border:1px solid #1e3650; padding:12px 14px; border-radius:12px; outline:none}
    .input::placeholder{color:#7aa5be}
    .btn{cursor:pointer; border:none; padding:12px 16px; border-radius:12px; font-weight:800; letter-spacing:.2px;
      background:linear-gradient(135deg,#19c37d,#0ea5e9); color:#def7ff; box-shadow:0 10px 24px rgba(14,165,233,.28);
      transition:transform .08s ease, filter .2s}
    .btn:active{transform:translateY(1px)}

    .filters{display:flex; gap:10px; flex-wrap:wrap; margin-top:12px}
    .chip{border:1px solid #1e3650; background:#0b1526; color:#cfeaff; padding:8px 10px; border-radius:999px; cursor:pointer}
    .chip.active{border-color:#19c37d; background:#0c1c30}

    .grid{display:grid; grid-template-columns:1.1fr .9fr .9fr; gap:16px; margin-top:16px}

    /* Column cards â€” float on hover */
    .card{background:linear-gradient(180deg, rgba(0,0,0,0.38), rgba(0,0,0,0.2)); border:1px solid var(--edge);
      border-radius:var(--radius); box-shadow:var(--shadow); padding:16px; min-height:280px;
      transition:transform .18s ease, box-shadow .18s ease}
    .card:hover{transform:translateY(-8px); box-shadow:0 16px 40px rgba(0,0,0,.55)}
    .card.today{border-top:4px solid var(--accentG)}
    .card.upcoming{border-top:4px solid var(--accentB)}
    .card.done{border-top:4px solid var(--accentC)}
    .card h3{margin:0 0 10px 0; display:inline-flex; align-items:center; gap:8px}
    .card h3::after{content:'â†—'; font-size:12px; opacity:.6; transition:transform .2s ease, opacity .2s}
    .card:hover h3::after{transform:translateY(-4px); opacity:1}

    .list{display:flex; flex-direction:column; gap:10px}

    .task{display:grid; grid-template-columns:auto 1fr auto; gap:10px; align-items:center; background:#0b1220; border:1px solid #1e3650; border-radius:14px; padding:12px; position:relative; overflow:hidden; color:#e6f7ff}
    .task.low{border-left:4px solid #19c37d}
    .task.med{border-left:4px solid #0ea5e9}
    .task.high{border-left:4px solid #f97316}

    .check{appearance:none; width:22px; height:22px; border-radius:7px; border:2px solid #3d5a73; display:grid; place-items:center; cursor:pointer; transition:all .25s ease; background:transparent}
    .check:checked{background:linear-gradient(135deg,#19c37d,#0ea5e9); border-color:transparent; box-shadow:0 6px 18px rgba(14,165,233,.25)}
    .check:checked::after{content:"âœ“"; font-weight:900; color:#04121d}

    .title{font-weight:800; color:#e6f7ff; text-shadow:0 1px 2px rgba(0,0,0,.35)}
    .meta{font-size:12px; color:#a7cbe0}

    .actions{display:flex; gap:8px}
    .icon-btn{background:#0b1526; border:1px solid #204769; color:#cde8ff; padding:8px 10px; border-radius:10px; cursor:pointer}
    .icon-btn:hover{border-color:#19c37d}

    .progress{height:10px; background:#0b1526; border-radius:999px; overflow:hidden; border:1px solid #1e3650}
    .bar{height:100%; width:0%; background:linear-gradient(90deg,#19c37d,#06b6d4,#0ea5e9); transition:width .45s ease}
    .stats{display:flex; align-items:center; gap:12px; color:#a7cbe0}

    /* drag & drop helpers */
    .card.drop-hover{outline:2px dashed #19c37d; outline-offset:4px}
    .task.dragging{opacity:.6; transform:scale(.98)}

    @media (max-width:920px){
      .grid{grid-template-columns:1fr}
      .add-bar{grid-template-columns:1fr 1fr 1fr auto}
      .add-bar input[type="date"]{display:none}
    }
  </style>
</head>
<body>
  <!-- Cursor glow layer -->
  <div class="cursor-glow" id="cursorGlow"></div>

  <div class="container">
    <header>
      <div class="brand">
        <div class="logo-text">Charan Tracker</div>
        <div>
     v
          <div class="today" id="todayText"></div>
        </div>
      </div>
      <div class="stats">
        <div style="min-width:180px">
          <div class="progress" aria-label="completion">
            <div class="bar" id="progressBar"></div>
          </div>
        </div>
        <span id="statText">0/0 done</span>
      </div>
    </header>

    <div class="panel add-bar" role="region" aria-label="Add task">
      <input id="taskInput" class="input" placeholder="Add a taskâ€¦ e.g., Study Python 30 mins" />
      <select id="priority">
        <option value="low">Low</option>
        <option value="med">Medium</option>
        <option value="high">High</option>
      </select>
      <select id="bucket">
        <option value="today">Today</option>
        <option value="upcoming">Upcoming</option>
      </select>
      <input id="due" class="input" type="date" />
      <button class="btn" id="addBtn">Add Task</button>
    </div>

    <div class="filters">
      <button class="chip active" data-filter="all">All</button>
      <button class="chip" data-filter="today">Today</button>
      <button class="chip" data-filter="upcoming">Upcoming</button>
      <button class="chip" data-filter="completed">Completed</button>
      <input id="search" class="input" style="max-width:260px" placeholder="Search tasks" />
      <button class="chip" id="clearDone">Clear completed</button>
    </div>

    <div class="grid" style="margin-top:18px">
      <section class="card today" aria-labelledby="col-today">
        <h3 id="col-today">Today</h3>
        <div class="list droptarget" id="list-today"></div>
      </section>
      <section class="card upcoming" aria-labelledby="col-upcoming">
        <h3 id="col-upcoming">Upcoming</h3>
        <div class="list droptarget" id="list-upcoming"></div>
      </section>
      <section class="card done" aria-labelledby="col-done">
        <h3 id="col-done">Completed</h3>
        <div class="list droptarget" id="list-done"></div>
      </section>
    </div>
  </div>

  <div class="toast" id="toast" role="status" aria-live="polite"></div>
  <!-- Confetti container -->
  <canvas id="confettiCanvas" style="position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:999;"></canvas>

  <script>
    // Tiny DOM helpers
    const $ = (q,root=document)=>root.querySelector(q);
    const $$ = (q,root=document)=>Array.from(root.querySelectorAll(q));
    const uid = ()=> Math.random().toString(36).slice(2,9);
    const STORAGE_KEY = 'charan.tracker.v2';

    const state = { tasks: loadTasks(), filter:'all', search:'' };

    function loadTasks(){ try{ return JSON.parse(localStorage.getItem(STORAGE_KEY)||'[]'); }catch(e){ return [] } }
    function saveTasks(){ localStorage.setItem(STORAGE_KEY, JSON.stringify(state.tasks)); }

    // Render lists, stats, progress
    function render(){
      const todayList = $('#list-today'), upcList=$('#list-upcoming'), doneList=$('#list-done');
      [todayList,upcList,doneList].forEach(el=> el.innerHTML='');

      const total = state.tasks.length; const completed = state.tasks.filter(t=>t.done).length;
      $('#statText').textContent = `${completed}/${total} done`;
      $('#progressBar').style.width = total? ((completed/total)*100).toFixed(1)+'%':'0%';

      state.tasks.forEach(t=>{
        const el = taskItem(t);
        if(t.done){ doneList.appendChild(el); }
        else if((t.bucket||'today')==='today'){ todayList.appendChild(el); }
        else { upcList.appendChild(el); }
      });

      const d = new Date();
      $('#todayText').textContent = d.toLocaleDateString(undefined,{weekday:'long', month:'short', day:'numeric', year:'numeric'});

      setupDnD(); // enable drag & drop after DOM is updated
    }

    function taskItem(task){
      const li = document.createElement('div');
      li.className = `task ${task.priority||'low'}`;
      li.dataset.id = task.id;

      // make draggable
      li.setAttribute('draggable','true');
      li.addEventListener('dragstart', (e)=>{
        li.classList.add('dragging');
        e.dataTransfer.setData('text/plain', task.id);
        e.dataTransfer.effectAllowed='move';
      });
      li.addEventListener('dragend', ()=> li.classList.remove('dragging'));

      li.innerHTML = `
        <input class="check" type="checkbox" ${task.done?'checked':''}>
        <div>
          <div class="title">${escapeHtml(task.title)}</div>
          <div class="meta">${(task.bucket||'today').toUpperCase()}${task.priority? ' â€¢ '+task.priority.toUpperCase():''}${task.due? ' â€¢ Due: '+task.due:''}</div>
        </div>
        <div class="actions">
          <button class="icon-btn" data-act="edit">Edit</button>
          <button class="icon-btn" data-act="move">Move</button>
          <button class="icon-btn" data-act="del">Delete</button>
        </div>`;

      // Checkbox complete (also celebrate)
      li.querySelector('.check').addEventListener('change', e=>{
        task.done = e.target.checked;
        saveTasks(); render();
        if (task.done) confettiBurst(); // celebrate on checkbox too
        toast(task.done?'Great job! âœ…':'Marked as not done');
      });

      li.querySelector('[data-act="del"]').addEventListener('click', ()=>{
        state.tasks = state.tasks.filter(x=>x.id!==task.id); saveTasks(); render(); toast('Task deleted');
      });
      li.querySelector('[data-act="edit"]').addEventListener('click', ()=>{
        const t = prompt('Edit task title', task.title);
        if(t!==null){ task.title=t.trim()||task.title; saveTasks(); render(); toast('Task updated'); }
      });
      li.querySelector('[data-act="move"]').addEventListener('click', ()=>{
        task.bucket = (task.bucket==='today')?'upcoming':'today'; saveTasks(); render(); toast('Task moved');
      });
      return li;
    }

    // Drag-and-drop wiring
    function setupDnD(){
      const zones = $$('.droptarget');
      zones.forEach(z =>{
        z.addEventListener('dragover', e=>{
          e.preventDefault();
          z.closest('.card').classList.add('drop-hover');
          e.dataTransfer.dropEffect='move';
        });
        z.addEventListener('dragleave', ()=>{
          z.closest('.card').classList.remove('drop-hover');
        });
        z.addEventListener('drop', e=>{
          e.preventDefault();
          z.closest('.card').classList.remove('drop-hover');

          const id = e.dataTransfer.getData('text/plain');
          const t = state.tasks.find(x=> x.id===id);
          if(!t) return;

          if (z.id === 'list-done') {            // Completed
            t.done = true;
            confettiBurst();                     // ðŸŽ‰ celebrate!
          } else if (z.id === 'list-today') {    // Today
            t.done = false; t.bucket = 'today';
          } else if (z.id === 'list-upcoming') { // Upcoming
            t.done = false; t.bucket = 'upcoming';
          }

          saveTasks(); render();
        });
      });
    }

    function addTask(){
      const input = $('#taskInput'); const title = (input.value||'').trim();
      if(!title){ toast('Please enter a task'); input.focus(); return; }
      const priority = $('#priority').value; const bucket = $('#bucket').value; const due = $('#due').value;
      const item = { id:uid(), title, priority, bucket, due, done:false, created:Date.now() };
      state.tasks.unshift(item); saveTasks(); input.value=''; render(); toast('Task added');
    }

    $$('.chip').forEach(ch=> ch.addEventListener('click', ()=>{
      if(ch.id==='clearDone'){ state.tasks = state.tasks.filter(t=>!t.done); saveTasks(); render(); toast('Cleared completed'); return; }
      $$('.chip').forEach(c=>c.classList.remove('active')); ch.classList.add('active'); state.filter = ch.dataset.filter; render();
    }));
    $('#search').addEventListener('input', e=>{ state.search = e.target.value.toLowerCase(); render(); });
    $('#addBtn').addEventListener('click', addTask);
    $('#taskInput').addEventListener('keydown', e=>{ if(e.key==='Enter') addTask(); });

    const toastEl = $('#toast'); let toastTimer;
    function toast(msg){ toastEl.textContent = msg; toastEl.classList.add('show'); clearTimeout(toastTimer); toastTimer=setTimeout(()=>toastEl.classList.remove('show'), 1600); }

    function escapeHtml(s){ return String(s).replace(/[&<>\"']/g, (ch)=>({ '&':'&amp;','<':'&lt;','>':'&gt;','\"':'&quot;','\'':'&#39;' }[ch])); }

    // ===== Cursor glow follow =====
    let pending = false, mx=0, my=0;
    window.addEventListener('mousemove', (e)=>{ mx = e.clientX + 'px'; my = e.clientY + 'px'; if(!pending){ pending = true; requestAnimationFrame(()=>{ document.documentElement.style.setProperty('--mx', mx); document.documentElement.style.setProperty('--my', my); pending=false; }); } });
    window.addEventListener('mouseleave', ()=> document.body.classList.add('no-glow'));
    window.addEventListener('mouseenter', ()=> document.body.classList.remove('no-glow'));

    // === Confetti celebration when task completed ===
    function confettiBurst(count = 150) {
      const canvas = document.getElementById("confettiCanvas");
      const ctx = canvas.getContext("2d");
      const w = (canvas.width = window.innerWidth);
      const h = (canvas.height = window.innerHeight);
      const pieces = [];
      // gold + royal blue palette for "glory"
      const palette = ["#FFD700","#F5C518","#1E3A8A","#2563EB"];

      for (let i = 0; i < count; i++) {
        pieces.push({
          x: Math.random() * w,
          y: Math.random() * -h,
          r: Math.random() * 6 + 4,
          c: palette[Math.floor(Math.random()*palette.length)],
          s: Math.random() * 4 + 2,
          a: Math.random() * Math.PI * 2
        });
      }

      const gravity = 0.3;
      let frame = 0;
      let raf;

      function draw() {
        ctx.clearRect(0, 0, w, h);
        frame++;
        for (const p of pieces) {
          p.y += p.s + gravity;
          p.x += Math.sin(p.a + frame * 0.02) * 2;
          if (p.y > h) { p.y = -10; p.x = Math.random()*w; }
          ctx.beginPath();
          ctx.fillStyle = p.c;
          ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2);
          ctx.fill();
        }
        raf = requestAnimationFrame(draw);
      }
      draw();

      // stop after few seconds
      setTimeout(() => { cancelAnimationFrame(raf); ctx.clearRect(0, 0, w, h); }, 4000);
    }

    // Init
    render();
  </script>
</body>
</html>
